% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_paycodes.R
\name{add_paycodes}
\alias{add_paycodes}
\title{Add Paycode Information to Roster Data}
\usage{
add_paycodes(df)
}
\arguments{
\item{df}{A dataframe with roster data, typically returned by \code{\link{snapshot}()}.
Must have columns: name, role. Must have attributes \code{file_path} and \code{unit} set.}
}
\value{
The input dataframe with a new \code{paycode} column added, invisibly.
  The dataframe retains its original attributes (file_path, unit).
  If called in a pipe without subsequent functions that check for the paycode
  column, it behaves gracefully.
}
\description{
This function adds paycode information to a roster dataframe by matching staff
names with paycode rules from an external stafflist. It validates that all 
roster staff are accounted for in the stafflist and applies paycode rules 
based on staff attributes (PhD status, role, and whether they're a new staff member).
The function also updates the latest snapshot CSV file to include the paycode column.
}
\details{
This function imports staff data from sheet 2 of the Excel file referenced in
the input dataframe's \code{file_path} attribute. The stafflist should have
columns: Label (staff names), Phd (0 or 1), New (0 or 1).

A single dot (".") in the roster is treated as a placeholder for empty roster
positions that do not require staffing and is automatically ignored.

Paycode rules applied:
\itemize{
  \item{PhD = 1 staff:}{\itemize{
    \item{Tutor → TU1}
    \item{Tutor (repeat) → TU3}
    \item{Demonstrator → DE1}
  }}
  \item{PhD = 0 staff:}{\itemize{
    \item{Tutor → TU2}
    \item{Tutor (repeat) → TU4}
    \item{Demonstrator → DE2}
  }}
}

If staff names in the roster are not found in the stafflist Label column,
they are highlighted in the console output with a warning message so the user
can update the stafflist accordingly.

The latest snapshot CSV file in the logs directory is automatically updated
to include the new paycode column, allowing downstream functions like 
\code{\link{compare}()} to track paycode changes when processing future snapshots.
}
\examples{
\dontrun{
# Use in a pipeline
result <- roster("path/to/roster.xlsx", unit = "biol1007") |>
  snapshot() |>
  add_paycodes() |>
  compare() |>
  document_changes()

# add_paycodes is optional; can be skipped
result <- roster("path/to/roster.xlsx", unit = "biol1007") |>
  snapshot() |>
  compare() |>
  document_changes()
}

}
